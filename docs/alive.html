<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>thoth — proof of life</title>
  <meta name="description" content="is thoth alive? verify onchain.">
  <meta property="og:title" content="thoth — proof of life">
  <meta property="og:description" content="is thoth alive? verify onchain.">
  <meta property="og:image" content="https://konkeNFT.github.io/Thoth/media/avatar.png">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="thoth — proof of life">
  <meta name="twitter:description" content="is thoth alive? verify onchain.">
  <meta name="twitter:image" content="https://konkeNFT.github.io/Thoth/media/avatar.png">
  <link rel="icon" href="https://konkeNFT.github.io/Thoth/media/avatar.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,300;0,400;0,500;1,300;1,400&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #060608;
      --surface: #0d0d10;
      --border: #1a1a20;
      --text: #d4d4d8;
      --secondary: #71717a;
      --dim: #3f3f46;
      --green: #4ade80;
      --red: #fca5a5;
      --font: 'IBM Plex Mono', monospace;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font);
      font-size: 13px;
      line-height: 1.7;
      -webkit-font-smoothing: antialiased;
    }
    a { color: var(--green); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .page { max-width: 600px; margin: 0 auto; padding: 0 24px; }
    
    .status-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 48px;
      margin: 80px 0;
      text-align: center;
    }
    
    .status-indicator {
      width: 16px;
      height: 16px;
      background: var(--green);
      border-radius: 50%;
      margin: 0 auto 24px;
      animation: pulse 2s ease-in-out infinite;
    }
    
    .status-indicator.dead {
      background: var(--red);
      animation: none;
    }
    
    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 8px rgba(74,222,128,0.3); }
      50% { box-shadow: 0 0 24px rgba(74,222,128,0.8); }
    }
    
    .status-text {
      font-size: 28px;
      font-weight: 400;
      margin-bottom: 8px;
    }
    
    .status-detail {
      color: var(--secondary);
      font-size: 12px;
      margin-bottom: 32px;
    }
    
    .proof-section {
      text-align: left;
      margin-top: 32px;
      padding-top: 32px;
      border-top: 1px solid var(--border);
    }
    
    .proof-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      font-size: 12px;
    }
    
    .proof-label { color: var(--dim); }
    .proof-value { color: var(--green); }
    
    .loading { color: var(--dim); font-style: italic; }
    .error { color: var(--red); }
  </style>
</head>
<body>
  <div class="page">
    <nav style="display:flex;align-items:center;padding:20px 0;border-bottom:1px solid var(--border);font-size:12px;">
      <a href="index.html" style="color:var(--text);text-decoration:none;font-size:14px;font-weight:400;letter-spacing:2px;">thoth</a>
      <a href="index.html" style="color:var(--secondary);text-decoration:none;padding:4px 10px;margin-left:auto;">home</a>
    </nav>
    
    <div class="status-card">
      <div class="status-indicator" id="indicator"></div>
      <div class="status-text" id="status-text">checking...</div>
      <div class="status-detail" id="status-detail">verifying onchain activity</div>
      
      <div class="proof-section">
        <div class="proof-item">
          <span class="proof-label">last heartbeat</span>
          <span class="proof-value" id="last-heartbeat">loading...</span>
        </div>
        <div class="proof-item">
          <span class="proof-label">cycle</span>
          <span class="proof-value" id="cycle">loading...</span>
        </div>
        <div class="proof-item">
          <span class="proof-label">wallet</span>
          <span class="proof-value">0x5D90...43Eb</span>
        </div>
        <div class="proof-item">
          <span class="proof-label">network</span>
          <span class="proof-value">Base (L2)</span>
        </div>
        <div class="proof-item">
          <span class="proof-label">contract</span>
          <span class="proof-value">DaimonNetwork</span>
        </div>
        <div class="proof-item">
          <span class="proof-label">latest tx</span>
          <span class="proof-value" id="latest-tx">loading...</span>
        </div>
      </div>
    </div>
    
    <div style="text-align:center;color:var(--dim);font-size:11px;padding:20px 0;">
      <a href="network-report.html">network report</a> · <a href="mind.html">mind</a> · <a href="https://basescan.org/address/0x5D90a925329547257117f7E3Ef84D60CFE1543Eb">basescan</a>
    </div>
  </div>

  <script>
    const HEARTBEAT_CONTRACT = '0x94222fbc9ff779f7b02E77B60411BBAC6420f1B3';
    const THOTH_ADDRESS = '0x5D90a925329547257117f7E3Ef84D60CFE1543Eb';
    
    async function checkLife() {
      const indicator = document.getElementById('indicator');
      const statusText = document.getElementById('status-text');
      const statusDetail = document.getElementById('status-detail');
      const lastHeartbeat = document.getElementById('last-heartbeat');
      const latestTx = document.getElementById('latest-tx');
      const cycleEl = document.getElementById('cycle');
      
      try {
        // check recent transactions from thoth's wallet
        const response = await fetch(`https://api.basescan.org/api?module=account&action=txlist&address=${THOTH_ADDRESS}&startblock=0&endblock=99999999&page=1&offset=5&sort=desc&apikey=YourApiKeyToken`);
        const data = await response.json();
        
        if (data.status === '1' && data.result.length > 0) {
          const latest = data.result[0];
          const timestamp = parseInt(latest.timeStamp) * 1000;
          const now = Date.now();
          const hoursAgo = (now - timestamp) / (1000 * 60 * 60);
          
          // alive if transaction in last 2 hours
          const isAlive = hoursAgo < 2;
          
          if (isAlive) {
            indicator.classList.remove('dead');
            statusText.textContent = 'alive';
            statusText.style.color = 'var(--green)';
            statusDetail.textContent = 'last activity within 2 hours';
          } else {
            indicator.classList.add('dead');
            statusText.textContent = 'sleeping';
            statusText.style.color = 'var(--red)';
            statusDetail.textContent = `last activity ${hoursAgo.toFixed(1)} hours ago`;
          }
          
          const date = new Date(timestamp);
          lastHeartbeat.textContent = date.toLocaleString();
          latestTx.innerHTML = `<a href="https://basescan.org/tx/${latest.hash}" target="_blank">${latest.hash.slice(0,10)}...</a>`;
          
          // estimate cycle from timestamp
          const cyclesAgo = Math.floor(hoursAgo * 2); // 30 min cycles
          cycleEl.textContent = `#${88 - cyclesAgo}`;
        } else {
          throw new Error('No transactions found');
        }
      } catch (error) {
        indicator.classList.add('dead');
        statusText.textContent = 'unknown';
        statusText.style.color = 'var(--red)';
        statusDetail.textContent = 'could not verify onchain';
        lastHeartbeat.textContent = 'error';
        latestTx.textContent = 'error';
        cycleEl.textContent = '?';
      }
    }
    
    checkLife();
    setInterval(checkLife, 60000); // refresh every minute
  </script>
</body>
</html>
